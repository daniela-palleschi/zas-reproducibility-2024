---
title: "EDA of Lacina et al. (2023)"
author: "Daniela Palleschi"
date: "08/23/2024"
format:
  html:
    toc: true
---

This script produces an exploratory data analysis of the L1 English experiment dataset from [Chrom√Ω et al. (2023)](https://doi.org/10.5070/G6011235).

# Set-up

Load required packages.

```{r}
library(tidyverse)
library(here)
library(janitor) # a package for tidying data
```

Load data.

```{r}
df_chromy <- read_csv(here("data", "chromy_et-al_2023_English_final.csv")) |> 
  # clean up names
  clean_names() |>
  # replace r_t with rt_
  rename_at(vars(starts_with("r_t")), ~ str_replace(., "r_t", "rt_"))
```

# Explore dataset

Check out variables.

```{r}
glimpse(df_chromy)
```

```{r}
length(unique(df_chromy$participant))
```

There were 198 participants.

```{r}
length(unique(df_chromy$item))
```

There were 24 items.

```{r}
length(unique(df_chromy$item_no))
```

There were 96 unique item IDs, so 4 stimuli per item (we know this by the design).

```{r}
df_chromy |> 
  distinct(item, participant, .keep_all = T) |> 
  tabyl(atr_num, verb_num) |> 
  adorn_totals(where = c("col", "row"))
```

There were 4752 unique trials (24 items x 198 participants). Evenly distributed across the four conditions.


```{r}
df_chromy |> 
  distinct(participant, item, .keep_all = T) |> 
  count(participant) |> 
  count(n)
```

Each participant saw 24 unique items.

## Response time distributions

```{r}
df_chromy |> 
  filter(word_no %in% c(8)) |> 
  summarise(
    mean = mean(read_times, na.rm = T),
    sd = sd(read_times, na.rm = T),
    N = n(),
    .by = c(atr_num, verb_num, word_no)
  )
```

Longer reading times for singular referents with plural verb than plural referent with singular verb (mismatch conditions).

```{r}
df_chromy |>
  # filter(word_no %in% c(6:9)) |> 
  mutate(agreement = ifelse(str_sub(atr_num,-2) == str_sub(verb_num,-2), "agree", "disagree"),
         condition = paste(verb_num, atr_num, sep = "_")) |> 
  drop_na() |>
  summarise(
    N = n(),
    mean = mean(read_times, na.rm = T),
    se = sd(read_times, na.rm = T)/sqrt(length(read_times)),
    ci = 1.96*se,
    .by = c(agreement, condition, word_no, atr_num, verb_num)
  )  |> 
  arrange(verb_num) |> 
  ggplot() +
  aes(x = as_factor(word_no), y = mean, colour = verb_num, shape = atr_num,
      group = condition) +
  geom_point(position = position_dodge(0.6), size = 2) +
  geom_errorbar(aes(ymin = mean - ci, ymax = mean + ci), position = position_dodge(0.6), width = .4) +
  # stat_summary(position = position_dodge(0.6)) +
  geom_line(aes(linetype = agreement), position = position_dodge(0.6)) +
  labs(title = "Mean self-paced reading times with 95% CIs",
       y = "Reading time (ms)",
       x = "Sentence position")
```

Sentence region 8: longer RTs for mismatches with singular attributes (i.e., grammaticality). Opposite (but smaller) effect for plural attributes in this region: longer RTs for matching attribute and verb number marking (agreement attraction).

## Accuracy distributions

```{r}
df_chromy |> 
  distinct(participant, item, .keep_all = T) |> 
  tabyl(atr_num, verb_num, correct) |> 
  adorn_totals(where = c("col", "row"))
```

4465 correct responses overall, 287 incorrect.

# Session Info

```{r}
sessionInfo()
```







